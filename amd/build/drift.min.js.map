{"version":3,"sources":["../src/drift.js"],"names":["define","$","str","t","window","driftt","drift","init","invoked","console","error","methods","factory","e","n","Array","prototype","slice","call","arguments","unshift","push","forEach","load","Math","ceil","Date","o","document","createElement","type","async","crossorigin","src","i","getElementsByTagName","parentNode","insertBefore","SNIPPET_VERSION","clientKey","on","api","click","preventDefault","sidebar","open","getScript","testConnection","message","get_string","when","done","localizedMessage","showWelcomeMessage","sendData","params","identify","userid","data"],"mappings":"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","sourcesContent":["/**\n * This file is part of Moodle - http://moodle.org/\n *\n * Moodle is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Moodle is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n *\n * @package   local_drift\n * @author    Guillermo Leon Alvarez Salamanca\n * @copyright Copyright (c) 2018 Open LMS (https://www.openlms.net)\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * JS code to load the javascript Drift client.\n */\ndefine(['jquery','core/str'], function($, str) {\n\n    /* eslint-disable */\n    // Start of Async Drift Code.\n    \"use strict\";\n    !function() {\n        var t = window.driftt = window.drift = window.driftt || [];\n        if (!t.init) {\n            if (t.invoked) return void (window.console && console.error && console.error(\"Drift snippet included twice.\"));\n            t.invoked = !0, t.methods = [ \"identify\", \"config\", \"track\", \"reset\", \"debug\", \"show\", \"ping\", \"page\", \"hide\", \"off\", \"on\" ],\n                t.factory = function(e) {\n                    return function() {\n                        var n = Array.prototype.slice.call(arguments);\n                        return n.unshift(e), t.push(n), t;\n                    };\n                }, t.methods.forEach(function(e) {\n                t[e] = t.factory(e);\n            }), t.load = function(t) {\n                    var e = 3e5, n = Math.ceil(new Date() / e) * e, o = document.createElement(\"script\");\n                    o.type = \"text/javascript\", o.async = !0, o.crossorigin = \"anonymous\", o.src = \"https://js.driftt.com/include/\" + n + \"/\" + t + \".js\";\n                    var i = document.getElementsByTagName(\"script\")[0];\n                    i.parentNode.insertBefore(o, i);\n            };\n        }\n    }();\n    drift.SNIPPET_VERSION = '0.3.1';\n    // End of Async Drift Code.\n\n    /**\n     * Load drift client.\n     * @param {string} clientKey\n     */\n    var load = function (clientKey) {\n        drift.load(clientKey);\n    };\n\n    var DRIFT_WIDGET_SELECTOR = '.drift-open-widget'\n\n    $(function() {\n        drift.on('ready', (api) => {\n            $(DRIFT_WIDGET_SELECTOR).click((e) => {\n                e.preventDefault();\n                api.sidebar.open();\n            });\n        });\n    });\n    /* eslint-enable */\n    return {\n\n        /**\n         * Get the url of the script.\n         */\n        /* eslint-disable */\n        getScript: function(t) {\n            var e = 3e5, n = Math.ceil(new Date() / e) * e, o = document.createElement(\"script\");\n            o.type = \"text/javascript\", o.async = !0, o.crossorigin = \"anonymous\", o.src = \"https://js.driftt.com/embeds/\" + n + \"/\" + t + \".json\";\n            return o;\n        },\n\n        /**\n         * Initialize Drift.\n         */\n        init: function(clientKey) {\n            load(clientKey);\n        },\n\n        /**\n         * Test Drift connection.\n         */\n        testConnection: function(clientKey) {\n            load(clientKey);\n            var message = str.get_string('drift_welcome_message', 'local_drift');\n\n            $.when(message).done(function(localizedMessage) {\n                drift.on('ready',function(api) {\n                    api.showWelcomeMessage({\n                        message: localizedMessage\n                    });\n                });\n            });\n        },\n\n        /**\n         * Send user data to Drift.\n         * @param {string} clientKey\n         * @param {array} params\n         */\n        sendData: function (clientKey, params) {\n            load(clientKey);\n            drift.identify(params.userid, params.data);\n        }\n        /* eslint-enable */\n    };\n});\n"],"file":"drift.min.js"}