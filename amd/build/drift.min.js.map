{"version":3,"file":"drift.min.js","sources":["../src/drift.js"],"sourcesContent":["/**\n * This file is part of Moodle - http://moodle.org/\n *\n * Moodle is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Moodle is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n *\n * @author    Guillermo Leon Alvarez Salamanca\n * @copyright Copyright (c) 2018 Open LMS (https://www.openlms.net)\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * JS code to load the javascript Drift client.\n */\ndefine(['jquery','core/str'], function($, str) {\n\n    /* eslint-disable */\n    // Start of Async Drift Code.\n    \"use strict\";\n    !function() {\n        var t = window.driftt = window.drift = window.driftt || [];\n        if (!t.init) {\n            if (t.invoked) return void (window.console && console.error && console.error(\"Drift snippet included twice.\"));\n            t.invoked = !0, t.methods = [ \"identify\", \"config\", \"track\", \"reset\", \"debug\", \"show\", \"ping\", \"page\", \"hide\", \"off\", \"on\" ],\n                t.factory = function(e) {\n                    return function() {\n                        var n = Array.prototype.slice.call(arguments);\n                        return n.unshift(e), t.push(n), t;\n                    };\n                }, t.methods.forEach(function(e) {\n                t[e] = t.factory(e);\n            }), t.load = function(t) {\n                    var e = 3e5, n = Math.ceil(new Date() / e) * e, o = document.createElement(\"script\");\n                    o.type = \"text/javascript\", o.async = !0, o.crossorigin = \"anonymous\", o.src = \"https://js.driftt.com/include/\" + n + \"/\" + t + \".js\";\n                    var i = document.getElementsByTagName(\"script\")[0];\n                    i.parentNode.insertBefore(o, i);\n            };\n        }\n    }();\n    drift.SNIPPET_VERSION = '0.3.1';\n    // End of Async Drift Code.\n\n    /**\n     * Load drift client.\n     * @param {string} clientKey\n     */\n    var load = function (clientKey) {\n        drift.load(clientKey);\n    };\n\n    var DRIFT_WIDGET_SELECTOR = '.drift-open-widget'\n\n    $(function() {\n        drift.on('ready', (api) => {\n            $(DRIFT_WIDGET_SELECTOR).click((e) => {\n                e.preventDefault();\n                api.sidebar.open();\n            });\n        });\n    });\n    /* eslint-enable */\n    return {\n\n        /**\n         * Get the url of the script.\n         */\n        /* eslint-disable */\n        getScript: function(t) {\n            var e = 3e5, n = Math.ceil(new Date() / e) * e, o = document.createElement(\"script\");\n            o.type = \"text/javascript\", o.async = !0, o.crossorigin = \"anonymous\", o.src = \"https://js.driftt.com/embeds/\" + n + \"/\" + t + \".json\";\n            return o;\n        },\n\n        /**\n         * Initialize Drift.\n         */\n        init: function(clientKey) {\n            load(clientKey);\n        },\n\n        /**\n         * Test Drift connection.\n         */\n        testConnection: function(clientKey) {\n            load(clientKey);\n            var message = str.get_string('drift_welcome_message', 'local_drift');\n\n            $.when(message).done(function(localizedMessage) {\n                drift.on('ready',function(api) {\n                    api.showWelcomeMessage({\n                        message: localizedMessage\n                    });\n                });\n            });\n        },\n\n        /**\n         * Send user data to Drift.\n         * @param {string} clientKey\n         * @param {array} params\n         */\n        sendData: function (clientKey, params) {\n            load(clientKey);\n            drift.identify(params.userid, params.data);\n        }\n        /* eslint-enable */\n    };\n});\n"],"names":["define","$","str","t","window","driftt","drift","init","invoked","console","error","methods","factory","e","n","Array","prototype","slice","call","arguments","unshift","push","forEach","load","Math","ceil","Date","o","document","createElement","type","async","crossorigin","src","i","getElementsByTagName","parentNode","insertBefore","SNIPPET_VERSION","clientKey","on","api","click","preventDefault","sidebar","open","getScript","testConnection","message","get_string","when","done","localizedMessage","showWelcomeMessage","sendData","params","identify","userid","data"],"mappings":";;;;;;;;;;;;;;;;;;;;AAwBAA,2BAAO,CAAC,SAAS,aAAa,SAASC,EAAGC,MAKrC,eACOC,EAAIC,OAAOC,OAASD,OAAOE,MAAQF,OAAOC,QAAU,OACnDF,EAAEI,KAAM,IACLJ,EAAEK,QAAS,YAAaJ,OAAOK,SAAWA,QAAQC,OAASD,QAAQC,MAAM,kCAC7EP,EAAEK,SAAU,EAAIL,EAAEQ,QAAU,CAAE,WAAY,SAAU,QAAS,QAAS,QAAS,OAAQ,OAAQ,OAAQ,OAAQ,MAAO,MAClHR,EAAES,QAAU,SAASC,UACV,eACCC,EAAIC,MAAMC,UAAUC,MAAMC,KAAKC,kBAC5BL,EAAEM,QAAQP,GAAIV,EAAEkB,KAAKP,GAAIX,IAErCA,EAAEQ,QAAQW,SAAQ,SAAST,GAC9BV,EAAEU,GAAKV,EAAES,QAAQC,MACjBV,EAAEoB,KAAO,SAASpB,OACVU,EAAI,IAAKC,EAAIU,KAAKC,KAAK,IAAIC,KAASb,GAAKA,EAAGc,EAAIC,SAASC,cAAc,UAC3EF,EAAEG,KAAO,kBAAmBH,EAAEI,OAAQ,EAAIJ,EAAEK,YAAc,YAAaL,EAAEM,IAAM,iCAAmCnB,EAAI,IAAMX,EAAI,UAC5H+B,EAAIN,SAASO,qBAAqB,UAAU,GAChDD,EAAEE,WAAWC,aAAaV,EAAGO,KAhB5C,GAoBD5B,MAAMgC,gBAAkB,YAOpBf,KAAO,SAAUgB,WACjBjC,MAAMiB,KAAKgB,mBAKftC,GAAE,WACEK,MAAMkC,GAAG,SAAUC,MACfxC,EAJoB,sBAIKyC,OAAO7B,IAC5BA,EAAE8B,iBACFF,IAAIG,QAAQC,gBAKjB,CAMHC,UAAW,SAAS3C,OACZU,EAAI,IAAKC,EAAIU,KAAKC,KAAK,IAAIC,KAASb,GAAKA,EAAGc,EAAIC,SAASC,cAAc,iBAC3EF,EAAEG,KAAO,kBAAmBH,EAAEI,OAAQ,EAAIJ,EAAEK,YAAc,YAAaL,EAAEM,IAAM,gCAAkCnB,EAAI,IAAMX,EAAI,QACxHwB,GAMXpB,KAAM,SAASgC,WACXhB,KAAKgB,YAMTQ,eAAgB,SAASR,WACrBhB,KAAKgB,eACDS,QAAU9C,IAAI+C,WAAW,wBAAyB,eAEtDhD,EAAEiD,KAAKF,SAASG,MAAK,SAASC,kBAC1B9C,MAAMkC,GAAG,SAAQ,SAASC,KACtBA,IAAIY,mBAAmB,CACnBL,QAASI,0BAWzBE,SAAU,SAAUf,UAAWgB,QAC3BhC,KAAKgB,WACLjC,MAAMkD,SAASD,OAAOE,OAAQF,OAAOG"}